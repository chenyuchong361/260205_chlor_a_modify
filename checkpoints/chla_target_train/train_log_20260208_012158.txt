============================================================
Chla FNO-CBAM Target Training
============================================================
Timestamp: 20260208_012158
Log file: /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/train_log_20260208_012158.txt
World size: 8
Data dir: /data_new/chla_data_imputation_data_260125/chla_data_pretraining/filled_target_modified
SST dir: /data_new/chla_data_imputation_data_260125/chla_data_pretraining/sst_daily_fusion_target_modified/
Resume checkpoint: None
Output dir: /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train
Learning rate: 0.0002
Mask ratio: 0.25
============================================================
Skipped 247 dates due to missing SST files
Found 2675 dates with valid Chl-a and SST
Built 2646 valid samples with complete 30-day windows
Preloading all data into memory...
  Loaded 1000/2675 files...
  Loaded 2000/2675 files...
Preloaded 2675 files into memory
Skipped 9 dates due to missing SST files
Found 357 dates with valid Chl-a and SST
Built 328 valid samples with complete 30-day windows
Preloading all data into memory...
Preloaded 357 files into memory
Train dataset: 2646 samples
Val dataset: 328 samples

Epoch 1/100
  LR: 0.000200
  Batch 0/20: loss=3.5455
  Train - loss: 1.7736
  Val   - loss: 0.5362
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 2/100
  LR: 0.000200
  Batch 0/20: loss=0.5428
  Train - loss: 0.2900
  Val   - loss: 0.1045
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 3/100
  LR: 0.000200
  Batch 0/20: loss=0.1017
  Train - loss: 0.2525
  Val   - loss: 0.4693

Epoch 4/100
  LR: 0.000200
  Batch 0/20: loss=0.4893
  Train - loss: 0.3717
  Val   - loss: 0.5352

Epoch 5/100
  LR: 0.000199
  Batch 0/20: loss=0.5038
  Train - loss: 0.3616
  Val   - loss: 0.3171

Epoch 6/100
  LR: 0.000199
  Batch 0/20: loss=0.3341
  Train - loss: 0.3306
  Val   - loss: 0.4786

Epoch 7/100
  LR: 0.000198
  Batch 0/20: loss=0.4850
  Train - loss: 0.3227
  Val   - loss: 0.3392

Epoch 8/100
  LR: 0.000198
  Batch 0/20: loss=0.3521
  Train - loss: 0.3151
  Val   - loss: 0.4563

Epoch 9/100
  LR: 0.000197
  Batch 0/20: loss=0.4539
  Train - loss: 0.3211
  Val   - loss: 0.3264

Epoch 10/100
  LR: 0.000196
  Batch 0/20: loss=0.3362
  Train - loss: 0.3046
  Val   - loss: 0.4359

Epoch 11/100
  LR: 0.000195
  Batch 0/20: loss=0.4353
  Train - loss: 0.2991
  Val   - loss: 0.3175

Epoch 12/100
  LR: 0.000194
  Batch 0/20: loss=0.3382
  Train - loss: 0.2994
  Val   - loss: 0.4271

Epoch 13/100
  LR: 0.000193
  Batch 0/20: loss=0.4204
  Train - loss: 0.2999
  Val   - loss: 0.2936

Epoch 14/100
  LR: 0.000192
  Batch 0/20: loss=0.3023
  Train - loss: 0.2904
  Val   - loss: 0.4264

Epoch 15/100
  LR: 0.000191
  Batch 0/20: loss=0.4104
  Train - loss: 0.2864
  Val   - loss: 0.2824

Epoch 16/100
  LR: 0.000189
  Batch 0/20: loss=0.2973
  Train - loss: 0.2844
  Val   - loss: 0.4241

Epoch 17/100
  LR: 0.000188
  Batch 0/20: loss=0.4362
  Train - loss: 0.2759
  Val   - loss: 0.2478

Epoch 18/100
  LR: 0.000186
  Batch 0/20: loss=0.2580
  Train - loss: 0.2731
  Val   - loss: 0.4285

Epoch 19/100
  LR: 0.000185
  Batch 0/20: loss=0.4318
  Train - loss: 0.2716
  Val   - loss: 0.2370

Epoch 20/100
  LR: 0.000183
  Batch 0/20: loss=0.2422
  Train - loss: 0.2671
  Val   - loss: 0.4317

Epoch 21/100
  LR: 0.000181
  Batch 0/20: loss=0.4290
  Train - loss: 0.2630
  Val   - loss: 0.2097

Epoch 22/100
  LR: 0.000179
  Batch 0/20: loss=0.2082
  Train - loss: 0.2614
  Val   - loss: 0.4279

Epoch 23/100
  LR: 0.000177
  Batch 0/20: loss=0.4321
  Train - loss: 0.2568
  Val   - loss: 0.1976

Epoch 24/100
  LR: 0.000175
  Batch 0/20: loss=0.1964
  Train - loss: 0.2527
  Val   - loss: 0.4279

Epoch 25/100
  LR: 0.000173
  Batch 0/20: loss=0.4121
  Train - loss: 0.2502
  Val   - loss: 0.1906

Epoch 26/100
  LR: 0.000171
  Batch 0/20: loss=0.2047
  Train - loss: 0.2517
  Val   - loss: 0.4144

Epoch 27/100
  LR: 0.000169
  Batch 0/20: loss=0.4095
  Train - loss: 0.2435
  Val   - loss: 0.1954

Epoch 28/100
  LR: 0.000166
  Batch 0/20: loss=0.2034
  Train - loss: 0.1066
  Val   - loss: 0.0596
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 29/100
  LR: 0.000164
  Batch 0/20: loss=0.0559
  Train - loss: 0.0979
  Val   - loss: 0.1419

Epoch 30/100
  LR: 0.000161
  Batch 0/20: loss=0.1519
  Train - loss: 0.1090
  Val   - loss: 0.1587

Epoch 31/100
  LR: 0.000159
  Batch 0/20: loss=0.1675
  Train - loss: 0.0938
  Val   - loss: 0.0588
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 32/100
  LR: 0.000156
  Batch 0/20: loss=0.0647
  Train - loss: 0.0928
  Val   - loss: 0.0552
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 33/100
  LR: 0.000154
  Batch 0/20: loss=0.0969
  Train - loss: 0.0928
  Val   - loss: 0.0547
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 34/100
  LR: 0.000151
  Batch 0/20: loss=0.0741
  Train - loss: 0.0918
  Val   - loss: 0.0541
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 35/100
  LR: 0.000148
  Batch 0/20: loss=0.0601
  Train - loss: 0.0884
  Val   - loss: 0.0545

Epoch 36/100
  LR: 0.000146
  Batch 0/20: loss=0.0535
  Train - loss: 0.0890
  Val   - loss: 0.0504
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 37/100
  LR: 0.000143
  Batch 0/20: loss=0.0650
  Train - loss: 0.0850
  Val   - loss: 0.0506

Epoch 38/100
  LR: 0.000140
  Batch 0/20: loss=0.0535
  Train - loss: 0.0848
  Val   - loss: 0.0508

Epoch 39/100
  LR: 0.000137
  Batch 0/20: loss=0.0564
  Train - loss: 0.0820
  Val   - loss: 0.0497
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 40/100
  LR: 0.000134
  Batch 0/20: loss=0.0514
  Train - loss: 0.0813
  Val   - loss: 0.0478
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 41/100
  LR: 0.000131
  Batch 0/20: loss=0.0545
  Train - loss: 0.0777
  Val   - loss: 0.0514

Epoch 42/100
  LR: 0.000128
  Batch 0/20: loss=0.0537
  Train - loss: 0.0751
  Val   - loss: 0.0515

Epoch 43/100
  LR: 0.000125
  Batch 0/20: loss=0.0514
  Train - loss: 0.0772
  Val   - loss: 0.0497

Epoch 44/100
  LR: 0.000122
  Batch 0/20: loss=0.0537
  Train - loss: 0.0763
  Val   - loss: 0.0499

Epoch 45/100
  LR: 0.000119
  Batch 0/20: loss=0.0513
  Train - loss: 0.0724
  Val   - loss: 0.0481

Epoch 46/100
  LR: 0.000116
  Batch 0/20: loss=0.0483
  Train - loss: 0.0714
  Val   - loss: 0.0458
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 47/100
  LR: 0.000113
  Batch 0/20: loss=0.0498
  Train - loss: 0.0727
  Val   - loss: 0.0503

Epoch 48/100
  LR: 0.000110
  Batch 0/20: loss=0.0475
  Train - loss: 0.0690
  Val   - loss: 0.0479

Epoch 49/100
  LR: 0.000107
  Batch 0/20: loss=0.0503
  Train - loss: 0.0667
  Val   - loss: 0.0505

Epoch 50/100
  LR: 0.000104
  Batch 0/20: loss=0.0547
  Train - loss: 0.0647
  Val   - loss: 0.0515

Epoch 51/100
  LR: 0.000100
  Batch 0/20: loss=0.0524
  Train - loss: 0.0623
  Val   - loss: 0.0484

Epoch 52/100
  LR: 0.000097
  Batch 0/20: loss=0.0465
  Train - loss: 0.0603
  Val   - loss: 0.0492

Epoch 53/100
  LR: 0.000094
  Batch 0/20: loss=0.0473
  Train - loss: 0.0606
  Val   - loss: 0.0500

Epoch 54/100
  LR: 0.000091
  Batch 0/20: loss=0.0462
  Train - loss: 0.0603
  Val   - loss: 0.0474

Epoch 55/100
  LR: 0.000088
  Batch 0/20: loss=0.0479
  Train - loss: 0.0575
  Val   - loss: 0.0497

Epoch 56/100
  LR: 0.000085
  Batch 0/20: loss=0.0484
  Train - loss: 0.0571
  Val   - loss: 0.0495

Epoch 57/100
  LR: 0.000082
  Batch 0/20: loss=0.0454
  Train - loss: 0.0542
  Val   - loss: 0.0461

Epoch 58/100
  LR: 0.000079
  Batch 0/20: loss=0.0478
  Train - loss: 0.0552
  Val   - loss: 0.0465

Epoch 59/100
  LR: 0.000076
  Batch 0/20: loss=0.0480
  Train - loss: 0.0539
  Val   - loss: 0.0461

Epoch 60/100
  LR: 0.000073
  Batch 0/20: loss=0.0482
  Train - loss: 0.0518
  Val   - loss: 0.0454
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 61/100
  LR: 0.000070
  Batch 0/20: loss=0.0440
  Train - loss: 0.0525
  Val   - loss: 0.0464

Epoch 62/100
  LR: 0.000067
  Batch 0/20: loss=0.0495
  Train - loss: 0.0510
  Val   - loss: 0.0458

Epoch 63/100
  LR: 0.000064
  Batch 0/20: loss=0.0513
  Train - loss: 0.0506
  Val   - loss: 0.0458

Epoch 64/100
  LR: 0.000061
  Batch 0/20: loss=0.0423
  Train - loss: 0.0491
  Val   - loss: 0.0432
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 65/100
  LR: 0.000058
  Batch 0/20: loss=0.0521
  Train - loss: 0.0494
  Val   - loss: 0.0437

Epoch 66/100
  LR: 0.000055
  Batch 0/20: loss=0.0435
  Train - loss: 0.0483
  Val   - loss: 0.0463

Epoch 67/100
  LR: 0.000053
  Batch 0/20: loss=0.0472
  Train - loss: 0.0480
  Val   - loss: 0.0467

Epoch 68/100
  LR: 0.000050
  Batch 0/20: loss=0.0501
  Train - loss: 0.0479
  Val   - loss: 0.0444

Epoch 69/100
  LR: 0.000047
  Batch 0/20: loss=0.0448
  Train - loss: 0.0462
  Val   - loss: 0.0463

Epoch 70/100
  LR: 0.000045
  Batch 0/20: loss=0.0485
  Train - loss: 0.0480
  Val   - loss: 0.0447

Epoch 71/100
  LR: 0.000042
  Batch 0/20: loss=0.0469
  Train - loss: 0.0465
  Val   - loss: 0.0451

Epoch 72/100
  LR: 0.000040
  Batch 0/20: loss=0.0450
  Train - loss: 0.0460
  Val   - loss: 0.0457

Epoch 73/100
  LR: 0.000037
  Batch 0/20: loss=0.0470
  Train - loss: 0.0459
  Val   - loss: 0.0451

Epoch 74/100
  LR: 0.000035
  Batch 0/20: loss=0.0434
  Train - loss: 0.0446
  Val   - loss: 0.0464

Epoch 75/100
  LR: 0.000032
  Batch 0/20: loss=0.0392
  Train - loss: 0.0436
  Val   - loss: 0.0447

Epoch 76/100
  LR: 0.000030
  Batch 0/20: loss=0.0479
  Train - loss: 0.0451
  Val   - loss: 0.0460

Epoch 77/100
  LR: 0.000028
  Batch 0/20: loss=0.0475
  Train - loss: 0.0432
  Val   - loss: 0.0451

Epoch 78/100
  LR: 0.000026
  Batch 0/20: loss=0.0488
  Train - loss: 0.0463
  Val   - loss: 0.0463

Epoch 79/100
  LR: 0.000024
  Batch 0/20: loss=0.0414
  Train - loss: 0.0434
  Val   - loss: 0.0416
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 80/100
  LR: 0.000022
  Batch 0/20: loss=0.0464
  Train - loss: 0.0436
  Val   - loss: 0.0410
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 81/100
  LR: 0.000020
  Batch 0/20: loss=0.0433
  Train - loss: 0.0428
  Val   - loss: 0.0403
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 82/100
  LR: 0.000018
  Batch 0/20: loss=0.0444
  Train - loss: 0.0429
  Val   - loss: 0.0411

Epoch 83/100
  LR: 0.000016
  Batch 0/20: loss=0.0424
  Train - loss: 0.0422
  Val   - loss: 0.0414

Epoch 84/100
  LR: 0.000015
  Batch 0/20: loss=0.0431
  Train - loss: 0.0405
  Val   - loss: 0.0401
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 85/100
  LR: 0.000013
  Batch 0/20: loss=0.0465
  Train - loss: 0.0414
  Val   - loss: 0.0404

Epoch 86/100
  LR: 0.000012
  Batch 0/20: loss=0.0419
  Train - loss: 0.0420
  Val   - loss: 0.0426

Epoch 87/100
  LR: 0.000010
  Batch 0/20: loss=0.0367
  Train - loss: 0.0419
  Val   - loss: 0.0409

Epoch 88/100
  LR: 0.000009
  Batch 0/20: loss=0.0372
  Train - loss: 0.0403
  Val   - loss: 0.0374
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 89/100
  LR: 0.000008
  Batch 0/20: loss=0.0404
  Train - loss: 0.0420
  Val   - loss: 0.0381

Epoch 90/100
  LR: 0.000007
  Batch 0/20: loss=0.0372
  Train - loss: 0.0422
  Val   - loss: 0.0395

Epoch 91/100
  LR: 0.000006
  Batch 0/20: loss=0.0417
  Train - loss: 0.0400
  Val   - loss: 0.0388

Epoch 92/100
  LR: 0.000005
  Batch 0/20: loss=0.0450
  Train - loss: 0.0406
  Val   - loss: 0.0407

Epoch 93/100
  LR: 0.000004
  Batch 0/20: loss=0.0416
  Train - loss: 0.0413
  Val   - loss: 0.0401

Epoch 94/100
  LR: 0.000003
  Batch 0/20: loss=0.0379
  Train - loss: 0.0407
  Val   - loss: 0.0390

Epoch 95/100
  LR: 0.000003
  Batch 0/20: loss=0.0395
  Train - loss: 0.0403
  Val   - loss: 0.0383

Epoch 96/100
  LR: 0.000002
  Batch 0/20: loss=0.0358
  Train - loss: 0.0400
  Val   - loss: 0.0392

Epoch 97/100
  LR: 0.000002
  Batch 0/20: loss=0.0443
  Train - loss: 0.0406
  Val   - loss: 0.0394

Epoch 98/100
  LR: 0.000001
  Batch 0/20: loss=0.0434
  Train - loss: 0.0403
  Val   - loss: 0.0423

Epoch 99/100
  LR: 0.000001
  Batch 0/20: loss=0.0377
  Train - loss: 0.0399
  Val   - loss: 0.0398

Epoch 100/100
  LR: 0.000001
  Batch 0/20: loss=0.0378
  Train - loss: 0.0396
  Val   - loss: 0.0398

============================================================
Training completed!
Best validation loss: 0.0374
============================================================

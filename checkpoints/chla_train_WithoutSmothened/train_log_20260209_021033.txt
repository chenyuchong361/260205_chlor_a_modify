============================================================
Chla FNO-CBAM Target Training
============================================================
Timestamp: 20260209_021033
Log file: /home/cyc/260205_chlor_a_modify/checkpoints/chla_train_WithoutSmothened/train_log_20260209_021033.txt
World size: 4
Data dir: /data_new/chla_data_imputation_data_260125/chla_data_pretraining/filled_target_modified
SST dir: /data_new/chla_data_imputation_data_260125/chla_data_pretraining/sst_daily_fusion_target_modified/
Resume checkpoint: None
Output dir: /home/cyc/260205_chlor_a_modify/checkpoints/chla_train_WithoutSmothened
Learning rate: 0.0002
Mask ratio: 0.25
Smooth label: False
============================================================
Skipped 247 dates due to missing SST files
Found 2675 dates with valid Chl-a and SST
Built 2646 valid samples with complete 30-day windows
Preloading all data into memory...
  Loaded 1000/2675 files...
  Loaded 2000/2675 files...
Preloaded 2675 files into memory
Skipped 9 dates due to missing SST files
Found 357 dates with valid Chl-a and SST
Built 328 valid samples with complete 30-day windows
Preloading all data into memory...
Preloaded 357 files into memory
Train dataset: 2646 samples
Val dataset: 328 samples

Epoch 1/100
  LR: 0.000200
  Batch 0/13: loss=5.8677
  Train - loss: 4.1200
  Val   - loss: 0.6530
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_train_WithoutSmothened/best_model.pth

Epoch 2/100
  LR: 0.000200
  Batch 0/13: loss=0.6832
  Train - loss: 0.6681
  Val   - loss: 0.4086
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_train_WithoutSmothened/best_model.pth

Epoch 3/100
  LR: 0.000200
  Batch 0/13: loss=0.5159
  Train - loss: 0.2486
  Val   - loss: 0.0863
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_train_WithoutSmothened/best_model.pth

Epoch 4/100
  LR: 0.000200
  Batch 0/13: loss=0.1134
  Train - loss: 0.1717
  Val   - loss: 0.1648

Epoch 5/100
  LR: 0.000199
  Batch 0/13: loss=0.1970
  Train - loss: 0.1717
  Val   - loss: 0.1290

Epoch 6/100
  LR: 0.000199
  Batch 0/13: loss=0.1230
  Train - loss: 0.2095
  Val   - loss: 0.2769

Epoch 7/100
  LR: 0.000198
  Batch 0/13: loss=0.3282
  Train - loss: 0.1562
  Val   - loss: 0.2643

Epoch 8/100
  LR: 0.000198
  Batch 0/13: loss=0.2603
  Train - loss: 0.2062
  Val   - loss: 0.2710

Epoch 9/100
  LR: 0.000197
  Batch 0/13: loss=0.2632
  Train - loss: 0.1747
  Val   - loss: 0.0625
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_train_WithoutSmothened/best_model.pth

Epoch 10/100
  LR: 0.000196
  Batch 0/13: loss=0.0698
  Train - loss: 0.1542
  Val   - loss: 0.1261

Epoch 11/100
  LR: 0.000195
  Batch 0/13: loss=0.1259
  Train - loss: 0.1484
  Val   - loss: 0.0891

Epoch 12/100
  LR: 0.000194
  Batch 0/13: loss=0.0956
  Train - loss: 0.1503
  Val   - loss: 0.2538

Epoch 13/100
  LR: 0.000193
  Batch 0/13: loss=0.2491
  Train - loss: 0.1864
  Val   - loss: 0.0558
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_train_WithoutSmothened/best_model.pth

Epoch 14/100
  LR: 0.000192
  Batch 0/13: loss=0.0581
  Train - loss: 0.1412
  Val   - loss: 0.1506

Epoch 15/100
  LR: 0.000191
  Batch 0/13: loss=0.1507
  Train - loss: 0.1268
  Val   - loss: 0.2233

Epoch 16/100
  LR: 0.000189
  Batch 0/13: loss=0.2212
  Train - loss: 0.1842
  Val   - loss: 0.1215

Epoch 17/100
  LR: 0.000188
  Batch 0/13: loss=0.1173
  Train - loss: 0.1343
  Val   - loss: 0.1293

Epoch 18/100
  LR: 0.000186
  Batch 0/13: loss=0.1207
  Train - loss: 0.1319
  Val   - loss: 0.0535
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_train_WithoutSmothened/best_model.pth

Epoch 19/100
  LR: 0.000185
  Batch 0/13: loss=0.0571
  Train - loss: 0.1749
  Val   - loss: 0.0771

Epoch 20/100
  LR: 0.000183
  Batch 0/13: loss=0.0745
  Train - loss: 0.1220
  Val   - loss: 0.0499
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_train_WithoutSmothened/best_model.pth

Epoch 21/100
  LR: 0.000181
  Batch 0/13: loss=0.0559
  Train - loss: 0.1706
  Val   - loss: 0.0738

Epoch 22/100
  LR: 0.000179
  Batch 0/13: loss=0.0762
  Train - loss: 0.1202
  Val   - loss: 0.0528

Epoch 23/100
  LR: 0.000177
  Batch 0/13: loss=0.0523
  Train - loss: 0.1372
  Val   - loss: 0.2475

Epoch 24/100
  LR: 0.000175
  Batch 0/13: loss=0.2555
  Train - loss: 0.1388
  Val   - loss: 0.1054

Epoch 25/100
  LR: 0.000173
  Batch 0/13: loss=0.1208
  Train - loss: 0.1762
  Val   - loss: 0.3475

Epoch 26/100
  LR: 0.000171
  Batch 0/13: loss=0.3468
  Train - loss: 0.2418
  Val   - loss: 0.1608

Epoch 27/100
  LR: 0.000169
  Batch 0/13: loss=0.1635
  Train - loss: 0.1128
  Val   - loss: 0.3508

Epoch 28/100
  LR: 0.000166
  Batch 0/13: loss=0.3487
  Train - loss: 0.2349
  Val   - loss: 0.3776

Epoch 29/100
  LR: 0.000164
  Batch 0/13: loss=0.3806
  Train - loss: 0.1285
  Val   - loss: 0.1131

Epoch 30/100
  LR: 0.000161
  Batch 0/13: loss=0.1223
  Train - loss: 0.1430
  Val   - loss: 0.2010

Epoch 31/100
  LR: 0.000159
  Batch 0/13: loss=0.2438
  Train - loss: 0.1574
  Val   - loss: 0.0460
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_train_WithoutSmothened/best_model.pth

Epoch 32/100
  LR: 0.000156
  Batch 0/13: loss=0.0449
  Train - loss: 0.0825
  Val   - loss: 0.0473

Epoch 33/100
  LR: 0.000154
  Batch 0/13: loss=0.0617
  Train - loss: 0.1825
  Val   - loss: 0.1698

Epoch 34/100
  LR: 0.000151
  Batch 0/13: loss=0.1747
  Train - loss: 0.1355
  Val   - loss: 0.1928

Epoch 35/100
  LR: 0.000148
  Batch 0/13: loss=0.1911
  Train - loss: 0.1442
  Val   - loss: 0.0506

Epoch 36/100
  LR: 0.000146
  Batch 0/13: loss=0.0493
  Train - loss: 0.1740
  Val   - loss: 0.0713

Epoch 37/100
  LR: 0.000143
  Batch 0/13: loss=0.0700
  Train - loss: 0.1598
  Val   - loss: 0.1828

Epoch 38/100
  LR: 0.000140
  Batch 0/13: loss=0.1843
  Train - loss: 0.1126
  Val   - loss: 0.2066

Epoch 39/100
  LR: 0.000137
  Batch 0/13: loss=0.2052
  Train - loss: 0.1358
  Val   - loss: 0.1305

Epoch 40/100
  LR: 0.000134
  Batch 0/13: loss=0.1293
  Train - loss: 0.1635
  Val   - loss: 0.0867

Epoch 41/100
  LR: 0.000131
  Batch 0/13: loss=0.0880
  Train - loss: 0.1048
  Val   - loss: 0.0558

Epoch 42/100
  LR: 0.000128
  Batch 0/13: loss=0.0536
  Train - loss: 0.2557
  Val   - loss: 0.2111

Epoch 43/100
  LR: 0.000125
  Batch 0/13: loss=0.2147
  Train - loss: 0.1156
  Val   - loss: 0.0736

Epoch 44/100
  LR: 0.000122
  Batch 0/13: loss=0.0847
  Train - loss: 0.1124
  Val   - loss: 0.1456

Epoch 45/100
  LR: 0.000119
  Batch 0/13: loss=0.1496
  Train - loss: 0.0950
  Val   - loss: 0.0535

Epoch 46/100
  LR: 0.000116
  Batch 0/13: loss=0.0584
  Train - loss: 0.0903
  Val   - loss: 0.1258

Epoch 47/100
  LR: 0.000113
  Batch 0/13: loss=0.1268
  Train - loss: 0.0974
  Val   - loss: 0.1778

Epoch 48/100
  LR: 0.000110
  Batch 0/13: loss=0.1888
  Train - loss: 0.2204
  Val   - loss: 0.0558

Epoch 49/100
  LR: 0.000107
  Batch 0/13: loss=0.0525
  Train - loss: 0.0975
  Val   - loss: 0.0599

Epoch 50/100
  LR: 0.000104
  Batch 0/13: loss=0.0762
  Train - loss: 0.1814
  Val   - loss: 0.3133

Epoch 51/100
  LR: 0.000100
  Batch 0/13: loss=0.3097
  Train - loss: 0.1090
  Val   - loss: 0.0955

Epoch 52/100
  LR: 0.000097
  Batch 0/13: loss=0.0890
  Train - loss: 0.0841
  Val   - loss: 0.1112

Epoch 53/100
  LR: 0.000094
  Batch 0/13: loss=0.1134
  Train - loss: 0.1827
  Val   - loss: 0.1559

Epoch 54/100
  LR: 0.000091
  Batch 0/13: loss=0.1579
  Train - loss: 0.0849
  Val   - loss: 0.1010

Epoch 55/100
  LR: 0.000088
  Batch 0/13: loss=0.1007
  Train - loss: 0.0786
  Val   - loss: 0.1341

Epoch 56/100
  LR: 0.000085
  Batch 0/13: loss=0.1368
  Train - loss: 0.1688
  Val   - loss: 0.0510

Epoch 57/100
  LR: 0.000082
  Batch 0/13: loss=0.0470
  Train - loss: 0.0746
  Val   - loss: 0.0526

Epoch 58/100
  LR: 0.000079
  Batch 0/13: loss=0.0478
  Train - loss: 0.1382
  Val   - loss: 0.2344

Epoch 59/100
  LR: 0.000076
  Batch 0/13: loss=0.2303
  Train - loss: 0.1129
  Val   - loss: 0.1174

Epoch 60/100
  LR: 0.000073
  Batch 0/13: loss=0.1235
  Train - loss: 0.1337
  Val   - loss: 0.1026

Epoch 61/100
  LR: 0.000070
  Batch 0/13: loss=0.1022
  Train - loss: 0.0815
  Val   - loss: 0.0516

Epoch 62/100
  LR: 0.000067
  Batch 0/13: loss=0.0501
  Train - loss: 0.0886
  Val   - loss: 0.0424
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_train_WithoutSmothened/best_model.pth

Epoch 63/100
  LR: 0.000064
  Batch 0/13: loss=0.0437
  Train - loss: 0.0856
  Val   - loss: 0.1100

Epoch 64/100
  LR: 0.000061
  Batch 0/13: loss=0.1087
  Train - loss: 0.1075
  Val   - loss: 0.0523

Epoch 65/100
  LR: 0.000058
  Batch 0/13: loss=0.0559
  Train - loss: 0.0829
  Val   - loss: 0.1177

Epoch 66/100
  LR: 0.000055
  Batch 0/13: loss=0.1208
  Train - loss: 0.1004
  Val   - loss: 0.0560

Epoch 67/100
  LR: 0.000053
  Batch 0/13: loss=0.0602
  Train - loss: 0.0925
  Val   - loss: 0.1784

Epoch 68/100
  LR: 0.000050
  Batch 0/13: loss=0.1780
  Train - loss: 0.0768
  Val   - loss: 0.0423
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_train_WithoutSmothened/best_model.pth

Epoch 69/100
  LR: 0.000047
  Batch 0/13: loss=0.0439
  Train - loss: 0.0688
  Val   - loss: 0.0918

Epoch 70/100
  LR: 0.000045
  Batch 0/13: loss=0.0865
  Train - loss: 0.0845
  Val   - loss: 0.0495

Epoch 71/100
  LR: 0.000042
  Batch 0/13: loss=0.0568
  Train - loss: 0.0536
  Val   - loss: 0.0463

Epoch 72/100
  LR: 0.000040
  Batch 0/13: loss=0.0442
  Train - loss: 0.0534
  Val   - loss: 0.0526

Epoch 73/100
  LR: 0.000037
  Batch 0/13: loss=0.0575
  Train - loss: 0.0546
  Val   - loss: 0.0453

Epoch 74/100
  LR: 0.000035
  Batch 0/13: loss=0.0433
  Train - loss: 0.0565
  Val   - loss: 0.0424

Epoch 75/100
  LR: 0.000032
  Batch 0/13: loss=0.0475
  Train - loss: 0.0583
  Val   - loss: 0.0468

Epoch 76/100
  LR: 0.000030
  Batch 0/13: loss=0.0474
  Train - loss: 0.0510
  Val   - loss: 0.0592

Epoch 77/100
  LR: 0.000028
  Batch 0/13: loss=0.0560
  Train - loss: 0.0538
  Val   - loss: 0.0410
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_train_WithoutSmothened/best_model.pth

Epoch 78/100
  LR: 0.000026
  Batch 0/13: loss=0.0407
  Train - loss: 0.0659
  Val   - loss: 0.0583

Epoch 79/100
  LR: 0.000024
  Batch 0/13: loss=0.0555
  Train - loss: 0.0483
  Val   - loss: 0.0415

Epoch 80/100
  LR: 0.000022
  Batch 0/13: loss=0.0412
  Train - loss: 0.0458
  Val   - loss: 0.0512

Epoch 81/100
  LR: 0.000020
  Batch 0/13: loss=0.0506
  Train - loss: 0.0443
  Val   - loss: 0.0405
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_train_WithoutSmothened/best_model.pth

Epoch 82/100
  LR: 0.000018
  Batch 0/13: loss=0.0432
  Train - loss: 0.0421
  Val   - loss: 0.0419

Epoch 83/100
  LR: 0.000016
  Batch 0/13: loss=0.0410
  Train - loss: 0.0426
  Val   - loss: 0.0411

Epoch 84/100
  LR: 0.000015
  Batch 0/13: loss=0.0426
  Train - loss: 0.0425
  Val   - loss: 0.0399
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_train_WithoutSmothened/best_model.pth

Epoch 85/100
  LR: 0.000013
  Batch 0/13: loss=0.0420
  Train - loss: 0.0433
  Val   - loss: 0.0554

Epoch 86/100
  LR: 0.000012
  Batch 0/13: loss=0.0520
  Train - loss: 0.0480
  Val   - loss: 0.0419

Epoch 87/100
  LR: 0.000010
  Batch 0/13: loss=0.0409
  Train - loss: 0.0452
  Val   - loss: 0.0418

Epoch 88/100
  LR: 0.000009
  Batch 0/13: loss=0.0453
  Train - loss: 0.0432
  Val   - loss: 0.0393
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_train_WithoutSmothened/best_model.pth

Epoch 89/100
  LR: 0.000008
  Batch 0/13: loss=0.0402
  Train - loss: 0.0425
  Val   - loss: 0.0408

Epoch 90/100
  LR: 0.000007
  Batch 0/13: loss=0.0413
  Train - loss: 0.0425
  Val   - loss: 0.0407

Epoch 91/100
  LR: 0.000006
  Batch 0/13: loss=0.0407
  Train - loss: 0.0419
  Val   - loss: 0.0429

Epoch 92/100
  LR: 0.000005
  Batch 0/13: loss=0.0430
  Train - loss: 0.0432
  Val   - loss: 0.0400

Epoch 93/100
  LR: 0.000004
  Batch 0/13: loss=0.0459
  Train - loss: 0.0418
  Val   - loss: 0.0395

Epoch 94/100
  LR: 0.000003
  Batch 0/13: loss=0.0424
  Train - loss: 0.0414
  Val   - loss: 0.0379
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_train_WithoutSmothened/best_model.pth

Epoch 95/100
  LR: 0.000003
  Batch 0/13: loss=0.0391
  Train - loss: 0.0409
  Val   - loss: 0.0425

Epoch 96/100
  LR: 0.000002
  Batch 0/13: loss=0.0407
  Train - loss: 0.0415
  Val   - loss: 0.0411

Epoch 97/100
  LR: 0.000002
  Batch 0/13: loss=0.0425
  Train - loss: 0.0419
  Val   - loss: 0.0411

Epoch 98/100
  LR: 0.000001
  Batch 0/13: loss=0.0419
  Train - loss: 0.0410
  Val   - loss: 0.0395

Epoch 99/100
  LR: 0.000001
  Batch 0/13: loss=0.0399
  Train - loss: 0.0407
  Val   - loss: 0.0411

Epoch 100/100
  LR: 0.000001
  Batch 0/13: loss=0.0404
  Train - loss: 0.0410
  Val   - loss: 0.0392

============================================================
Training completed!
Best validation loss: 0.0379
============================================================

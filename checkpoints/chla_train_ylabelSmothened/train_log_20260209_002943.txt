============================================================
Chla FNO-CBAM Target Training
============================================================
Timestamp: 20260209_002943
Log file: /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/train_log_20260209_002943.txt
World size: 8
Data dir: /data_new/chla_data_imputation_data_260125/chla_data_pretraining/filled_target_modified
SST dir: /data_new/chla_data_imputation_data_260125/chla_data_pretraining/sst_daily_fusion_target_modified/
Resume checkpoint: None
Output dir: /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train
Learning rate: 0.0002
Mask ratio: 0.25
Smooth label: True
  Smooth kernel size: 5
  Smooth sigma: 1.0
============================================================
Skipped 247 dates due to missing SST files
Found 2675 dates with valid Chl-a and SST
Built 2646 valid samples with complete 30-day windows
Preloading all data into memory...
  Loaded 1000/2675 files...
  Loaded 2000/2675 files...
Preloaded 2675 files into memory
Skipped 9 dates due to missing SST files
Found 357 dates with valid Chl-a and SST
Built 328 valid samples with complete 30-day windows
Preloading all data into memory...
Preloaded 357 files into memory
Train dataset: 2646 samples
Val dataset: 328 samples

Epoch 1/100
  LR: 0.000200
  Batch 0/20: loss=8.3734
  Train - loss: 4.0224
  Val   - loss: 0.4893
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 2/100
  LR: 0.000200
  Batch 0/20: loss=0.4790
  Train - loss: 0.2942
  Val   - loss: 0.3195
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 3/100
  LR: 0.000200
  Batch 0/20: loss=0.3491
  Train - loss: 0.3195
  Val   - loss: 0.3108
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 4/100
  LR: 0.000200
  Batch 0/20: loss=0.3154
  Train - loss: 0.4165
  Val   - loss: 0.2390
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 5/100
  LR: 0.000199
  Batch 0/20: loss=0.2808
  Train - loss: 0.2845
  Val   - loss: 0.2223
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 6/100
  LR: 0.000199
  Batch 0/20: loss=0.2345
  Train - loss: 0.2730
  Val   - loss: 0.2378

Epoch 7/100
  LR: 0.000198
  Batch 0/20: loss=0.2656
  Train - loss: 0.1814
  Val   - loss: 0.1343
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 8/100
  LR: 0.000198
  Batch 0/20: loss=0.1387
  Train - loss: 0.1773
  Val   - loss: 0.0641
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 9/100
  LR: 0.000197
  Batch 0/20: loss=0.0621
  Train - loss: 0.1490
  Val   - loss: 0.1001

Epoch 10/100
  LR: 0.000196
  Batch 0/20: loss=0.0913
  Train - loss: 0.1381
  Val   - loss: 0.0767

Epoch 11/100
  LR: 0.000195
  Batch 0/20: loss=0.0645
  Train - loss: 0.1382
  Val   - loss: 0.0688

Epoch 12/100
  LR: 0.000194
  Batch 0/20: loss=0.0743
  Train - loss: 0.1356
  Val   - loss: 0.0693

Epoch 13/100
  LR: 0.000193
  Batch 0/20: loss=0.1041
  Train - loss: 0.1367
  Val   - loss: 0.0633
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 14/100
  LR: 0.000192
  Batch 0/20: loss=0.0601
  Train - loss: 0.1342
  Val   - loss: 0.0642

Epoch 15/100
  LR: 0.000191
  Batch 0/20: loss=0.0632
  Train - loss: 0.1342
  Val   - loss: 0.0597
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 16/100
  LR: 0.000189
  Batch 0/20: loss=0.0628
  Train - loss: 0.1296
  Val   - loss: 0.0653

Epoch 17/100
  LR: 0.000188
  Batch 0/20: loss=0.0582
  Train - loss: 0.1318
  Val   - loss: 0.0604

Epoch 18/100
  LR: 0.000186
  Batch 0/20: loss=0.0554
  Train - loss: 0.1245
  Val   - loss: 0.0617

Epoch 19/100
  LR: 0.000185
  Batch 0/20: loss=0.0542
  Train - loss: 0.1238
  Val   - loss: 0.0697

Epoch 20/100
  LR: 0.000183
  Batch 0/20: loss=0.0661
  Train - loss: 0.1232
  Val   - loss: 0.0636

Epoch 21/100
  LR: 0.000181
  Batch 0/20: loss=0.0656
  Train - loss: 0.1215
  Val   - loss: 0.0616

Epoch 22/100
  LR: 0.000179
  Batch 0/20: loss=0.0572
  Train - loss: 0.1198
  Val   - loss: 0.0554
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 23/100
  LR: 0.000177
  Batch 0/20: loss=0.0555
  Train - loss: 0.1183
  Val   - loss: 0.0588

Epoch 24/100
  LR: 0.000175
  Batch 0/20: loss=0.0592
  Train - loss: 0.1151
  Val   - loss: 0.0564

Epoch 25/100
  LR: 0.000173
  Batch 0/20: loss=0.0666
  Train - loss: 0.1159
  Val   - loss: 0.0628

Epoch 26/100
  LR: 0.000171
  Batch 0/20: loss=0.0633
  Train - loss: 0.1163
  Val   - loss: 0.0642

Epoch 27/100
  LR: 0.000169
  Batch 0/20: loss=0.0646
  Train - loss: 0.1163
  Val   - loss: 0.0614

Epoch 28/100
  LR: 0.000166
  Batch 0/20: loss=0.0714
  Train - loss: 0.1151
  Val   - loss: 0.0608

Epoch 29/100
  LR: 0.000164
  Batch 0/20: loss=0.0577
  Train - loss: 0.1112
  Val   - loss: 0.0645

Epoch 30/100
  LR: 0.000161
  Batch 0/20: loss=0.0657
  Train - loss: 0.1079
  Val   - loss: 0.0594

Epoch 31/100
  LR: 0.000159
  Batch 0/20: loss=0.0662
  Train - loss: 0.1034
  Val   - loss: 0.0551
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 32/100
  LR: 0.000156
  Batch 0/20: loss=0.0625
  Train - loss: 0.1003
  Val   - loss: 0.0550
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 33/100
  LR: 0.000154
  Batch 0/20: loss=0.0563
  Train - loss: 0.1000
  Val   - loss: 0.0576

Epoch 34/100
  LR: 0.000151
  Batch 0/20: loss=0.0539
  Train - loss: 0.1000
  Val   - loss: 0.0581

Epoch 35/100
  LR: 0.000148
  Batch 0/20: loss=0.0517
  Train - loss: 0.0965
  Val   - loss: 0.0584

Epoch 36/100
  LR: 0.000146
  Batch 0/20: loss=0.0597
  Train - loss: 0.0951
  Val   - loss: 0.0547
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 37/100
  LR: 0.000143
  Batch 0/20: loss=0.0676
  Train - loss: 0.0932
  Val   - loss: 0.0587

Epoch 38/100
  LR: 0.000140
  Batch 0/20: loss=0.0548
  Train - loss: 0.0940
  Val   - loss: 0.0534
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 39/100
  LR: 0.000137
  Batch 0/20: loss=0.0633
  Train - loss: 0.0921
  Val   - loss: 0.0533
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 40/100
  LR: 0.000134
  Batch 0/20: loss=0.0531
  Train - loss: 0.0889
  Val   - loss: 0.0551

Epoch 41/100
  LR: 0.000131
  Batch 0/20: loss=0.0569
  Train - loss: 0.0881
  Val   - loss: 0.0534

Epoch 42/100
  LR: 0.000128
  Batch 0/20: loss=0.0645
  Train - loss: 0.0848
  Val   - loss: 0.0509
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 43/100
  LR: 0.000125
  Batch 0/20: loss=0.0504
  Train - loss: 0.0829
  Val   - loss: 0.0527

Epoch 44/100
  LR: 0.000122
  Batch 0/20: loss=0.0530
  Train - loss: 0.0807
  Val   - loss: 0.0508
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 45/100
  LR: 0.000119
  Batch 0/20: loss=0.0515
  Train - loss: 0.0814
  Val   - loss: 0.0515

Epoch 46/100
  LR: 0.000116
  Batch 0/20: loss=0.0563
  Train - loss: 0.0782
  Val   - loss: 0.0531

Epoch 47/100
  LR: 0.000113
  Batch 0/20: loss=0.0516
  Train - loss: 0.0778
  Val   - loss: 0.0534

Epoch 48/100
  LR: 0.000110
  Batch 0/20: loss=0.0468
  Train - loss: 0.0718
  Val   - loss: 0.0521

Epoch 49/100
  LR: 0.000107
  Batch 0/20: loss=0.0512
  Train - loss: 0.0686
  Val   - loss: 0.0560

Epoch 50/100
  LR: 0.000104
  Batch 0/20: loss=0.0653
  Train - loss: 0.0679
  Val   - loss: 0.0540

Epoch 51/100
  LR: 0.000100
  Batch 0/20: loss=0.0588
  Train - loss: 0.0691
  Val   - loss: 0.0553

Epoch 52/100
  LR: 0.000097
  Batch 0/20: loss=0.0521
  Train - loss: 0.0644
  Val   - loss: 0.0518

Epoch 53/100
  LR: 0.000094
  Batch 0/20: loss=0.0507
  Train - loss: 0.0614
  Val   - loss: 0.0517

Epoch 54/100
  LR: 0.000091
  Batch 0/20: loss=0.0499
  Train - loss: 0.0618
  Val   - loss: 0.0528

Epoch 55/100
  LR: 0.000088
  Batch 0/20: loss=0.0565
  Train - loss: 0.0615
  Val   - loss: 0.0526

Epoch 56/100
  LR: 0.000085
  Batch 0/20: loss=0.0539
  Train - loss: 0.0596
  Val   - loss: 0.0513

Epoch 57/100
  LR: 0.000082
  Batch 0/20: loss=0.0475
  Train - loss: 0.0595
  Val   - loss: 0.0544

Epoch 58/100
  LR: 0.000079
  Batch 0/20: loss=0.0533
  Train - loss: 0.0593
  Val   - loss: 0.0549

Epoch 59/100
  LR: 0.000076
  Batch 0/20: loss=0.0534
  Train - loss: 0.0592
  Val   - loss: 0.0522

Epoch 60/100
  LR: 0.000073
  Batch 0/20: loss=0.0570
  Train - loss: 0.0552
  Val   - loss: 0.0518

Epoch 61/100
  LR: 0.000070
  Batch 0/20: loss=0.0535
  Train - loss: 0.0537
  Val   - loss: 0.0510

Epoch 62/100
  LR: 0.000067
  Batch 0/20: loss=0.0566
  Train - loss: 0.0534
  Val   - loss: 0.0533

Epoch 63/100
  LR: 0.000064
  Batch 0/20: loss=0.0529
  Train - loss: 0.0518
  Val   - loss: 0.0478
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 64/100
  LR: 0.000061
  Batch 0/20: loss=0.0455
  Train - loss: 0.0511
  Val   - loss: 0.0497

Epoch 65/100
  LR: 0.000058
  Batch 0/20: loss=0.0516
  Train - loss: 0.0502
  Val   - loss: 0.0522

Epoch 66/100
  LR: 0.000055
  Batch 0/20: loss=0.0543
  Train - loss: 0.0484
  Val   - loss: 0.0519

Epoch 67/100
  LR: 0.000053
  Batch 0/20: loss=0.0579
  Train - loss: 0.0498
  Val   - loss: 0.0530

Epoch 68/100
  LR: 0.000050
  Batch 0/20: loss=0.0551
  Train - loss: 0.0473
  Val   - loss: 0.0527

Epoch 69/100
  LR: 0.000047
  Batch 0/20: loss=0.0533
  Train - loss: 0.0461
  Val   - loss: 0.0520

Epoch 70/100
  LR: 0.000045
  Batch 0/20: loss=0.0515
  Train - loss: 0.0464
  Val   - loss: 0.0506

Epoch 71/100
  LR: 0.000042
  Batch 0/20: loss=0.0504
  Train - loss: 0.0445
  Val   - loss: 0.0525

Epoch 72/100
  LR: 0.000040
  Batch 0/20: loss=0.0493
  Train - loss: 0.0444
  Val   - loss: 0.0479

Epoch 73/100
  LR: 0.000037
  Batch 0/20: loss=0.0526
  Train - loss: 0.0445
  Val   - loss: 0.0450
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 74/100
  LR: 0.000035
  Batch 0/20: loss=0.0445
  Train - loss: 0.0435
  Val   - loss: 0.0461

Epoch 75/100
  LR: 0.000032
  Batch 0/20: loss=0.0387
  Train - loss: 0.0405
  Val   - loss: 0.0410
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 76/100
  LR: 0.000030
  Batch 0/20: loss=0.0455
  Train - loss: 0.0421
  Val   - loss: 0.0439

Epoch 77/100
  LR: 0.000028
  Batch 0/20: loss=0.0475
  Train - loss: 0.0408
  Val   - loss: 0.0437

Epoch 78/100
  LR: 0.000026
  Batch 0/20: loss=0.0491
  Train - loss: 0.0574
  Val   - loss: 0.0593

Epoch 79/100
  LR: 0.000024
  Batch 0/20: loss=0.0527
  Train - loss: 0.0522
  Val   - loss: 0.0785

Epoch 80/100
  LR: 0.000022
  Batch 0/20: loss=0.0843
  Train - loss: 0.0558
  Val   - loss: 0.0480

Epoch 81/100
  LR: 0.000020
  Batch 0/20: loss=0.0541
  Train - loss: 0.0509
  Val   - loss: 0.0685

Epoch 82/100
  LR: 0.000018
  Batch 0/20: loss=0.0711
  Train - loss: 0.0472
  Val   - loss: 0.0549

Epoch 83/100
  LR: 0.000016
  Batch 0/20: loss=0.0486
  Train - loss: 0.0472
  Val   - loss: 0.0616

Epoch 84/100
  LR: 0.000015
  Batch 0/20: loss=0.0620
  Train - loss: 0.0395
  Val   - loss: 0.0349
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 85/100
  LR: 0.000013
  Batch 0/20: loss=0.0397
  Train - loss: 0.0380
  Val   - loss: 0.0436

Epoch 86/100
  LR: 0.000012
  Batch 0/20: loss=0.0460
  Train - loss: 0.0459
  Val   - loss: 0.0369

Epoch 87/100
  LR: 0.000010
  Batch 0/20: loss=0.0376
  Train - loss: 0.0425
  Val   - loss: 0.0596

Epoch 88/100
  LR: 0.000009
  Batch 0/20: loss=0.0514
  Train - loss: 0.0468
  Val   - loss: 0.0340
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 89/100
  LR: 0.000008
  Batch 0/20: loss=0.0362
  Train - loss: 0.0409
  Val   - loss: 0.0391

Epoch 90/100
  LR: 0.000007
  Batch 0/20: loss=0.0407
  Train - loss: 0.0407
  Val   - loss: 0.0431

Epoch 91/100
  LR: 0.000006
  Batch 0/20: loss=0.0448
  Train - loss: 0.0401
  Val   - loss: 0.0425

Epoch 92/100
  LR: 0.000005
  Batch 0/20: loss=0.0485
  Train - loss: 0.0367
  Val   - loss: 0.0352

Epoch 93/100
  LR: 0.000004
  Batch 0/20: loss=0.0374
  Train - loss: 0.0372
  Val   - loss: 0.0345

Epoch 94/100
  LR: 0.000003
  Batch 0/20: loss=0.0370
  Train - loss: 0.0363
  Val   - loss: 0.0359

Epoch 95/100
  LR: 0.000003
  Batch 0/20: loss=0.0373
  Train - loss: 0.0358
  Val   - loss: 0.0338
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 96/100
  LR: 0.000002
  Batch 0/20: loss=0.0299
  Train - loss: 0.0355
  Val   - loss: 0.0354

Epoch 97/100
  LR: 0.000002
  Batch 0/20: loss=0.0381
  Train - loss: 0.0356
  Val   - loss: 0.0352

Epoch 98/100
  LR: 0.000001
  Batch 0/20: loss=0.0337
  Train - loss: 0.0357
  Val   - loss: 0.0338
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 99/100
  LR: 0.000001
  Batch 0/20: loss=0.0316
  Train - loss: 0.0358
  Val   - loss: 0.0325
  Saved best model to /home/cyc/260205_chlor_a_modify/checkpoints/chla_target_train/best_model.pth

Epoch 100/100
  LR: 0.000001
  Batch 0/20: loss=0.0298
  Train - loss: 0.0345
  Val   - loss: 0.0343

============================================================
Training completed!
Best validation loss: 0.0325
============================================================
